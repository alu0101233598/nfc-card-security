## Security analysis of the pseudorandom number generator (PRNG)

In order to run this script, it is necessary for the Android device used along to run the Frida server utility as tool. For more information on how to do this, please refer to the [official Frida documentation](https://frida.re/docs/android/).

### nonce.py

This program utilizes Frida to collect random nonces generated by the eID.

```bash
python nonce.py -w dump.txt -v
```

### Entropy assessment

The entropy assessment carried out during this research shows that the Spanish eID successfully meets the recommended security requirements, as per in [*Security Assessment of the Spanish Contactless Identity Card*](https://webdiis.unizar.es/~ricardo/files/papers/RG-IFS-17.pdf). The collected nonces are available in the dump.txt and dump.bin files in this directory.

- ent

```
Entropy = 7.999888 bits per byte.

Optimum compression would reduce the size
of this 1892288 byte file by 0 percent.

Chi square distribution for 1892288 samples is 293.76, and randomly
would exceed this value 4.79 percent of the times.

Arithmetic mean value of data bytes is 127.3730 (127.5 = random).
Monte Carlo value for Pi is 3.144044822 (error 0.08 percent).
Serial correlation coefficient is -0.000454 (totally uncorrelated = 0.0).
```

- rng-tools

```
rngtest 2.2
Copyright (c) 2004 by Henrique de Moraes Holschuh
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

rngtest: starting FIPS tests...
rngtest: entropy source exhausted!
rngtest: bits received from input: 15138304
rngtest: FIPS 140-2 successes: 756
rngtest: FIPS 140-2 failures: 0
rngtest: FIPS 140-2(2001-10-10) Monobit: 0
rngtest: FIPS 140-2(2001-10-10) Poker: 0
rngtest: FIPS 140-2(2001-10-10) Runs: 0
rngtest: FIPS 140-2(2001-10-10) Long run: 0
rngtest: FIPS 140-2(2001-10-10) Continuous run: 0
rngtest: input channel speed: (min=1.433; avg=7.044; max=9.313)Gibits/s
rngtest: FIPS tests speed: (min=73.078; avg=97.815; max=126.314)Mibits/s
rngtest: Program run time: 151896 microseconds
```
